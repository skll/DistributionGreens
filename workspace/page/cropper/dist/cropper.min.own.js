(function(k){"function"===typeof define&&define.amd?define(["jquery"],k):"object"===typeof exports?k(require("jquery")):k(jQuery)})(function(k){function p(a){return"number"===typeof a}function A(a,c){var b=[];p(c)&&b.push(c);return b.slice.apply(a,b)}function D(a,c){var b=A(arguments,2);return function(){return a.apply(c,b.concat(A(arguments)))}}function K(a){return(a=a.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i))&&(a[1]!==L.protocol||a[2]!==L.hostname||a[3]!==L.port)}function M(a){var c="timestamp="+
(new Date).getTime();return a+(-1===a.indexOf("?")?"?":"&")+c}function H(a,c){return 0>c.left&&a.width<c.left+c.width&&0>c.top&&a.height<c.top+c.height}function E(a){return a?"rotate("+a+"deg)":"none"}function F(a,c){var b=G(a.degree)%180,e=(90<b?180-b:b)*Math.PI/180,b=Q(e),f=R(e),d=a.width,g=a.height,h=a.aspectRatio;c?(e=d/(f+b/h),b=e/h):(e=d*f+g*b,b=d*b+g*f);return{width:e,height:b}}function r(a,c){this.$element=k(a);this.options=k.extend({},r.DEFAULTS,k.isPlainObject(c)&&c);this.disabled=this.cropped=
this.rotated=this.built=this.ready=!1;this.cropBox=this.canvas=null;this.load()}var B=k(window),I=k(document),L=window.location,S=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,O=k.isFunction(k("<canvas>")[0].getContext),P=Math.sqrt,t=Math.min,n=Math.max,G=Math.abs,Q=Math.sin,R=Math.cos,x=parseFloat,y={load:function(a){var c=this.options,b=this.$element,e,f,d,g;if(!a)if(b.is("img")){if(!b.attr("src"))return;a=b.prop("src")}else b.is("canvas")&&O&&(a=b[0].toDataURL());a&&(d=k.Event("build.cropper"),
b.one("build.cropper",c.build).trigger(d),d.isDefaultPrevented()||(c.checkImageOrigin&&K(a)&&(e="anonymous",b.prop("crossOrigin")||(f=M(a))),this.$clone=g=k("<img>"),g.one("load",k.proxy(function(){var b=g.prop("naturalWidth")||g.width(),c=g.prop("naturalHeight")||g.height();this.image={naturalWidth:b,naturalHeight:c,aspectRatio:b/c,rotate:0};this.url=a;this.ready=!0;this.build()},this)).one("error",function(){g.remove()}).attr({src:f||a,crossOrigin:e}),g.addClass("cropper-hide").insertAfter(b)))},
build:function(){var a=this.$element,c=this.$clone,b=this.options,e;this.ready&&(this.built&&this.unbuild(),this.$cropper=e=k(r.TEMPLATE),a.addClass("cropper-hidden"),c.removeClass("cropper-hide"),this.$container=a.parent().append(e),this.$canvas=e.find(".cropper-canvas").append(c),this.$dragBox=e.find(".cropper-drag-box"),this.$cropBox=c=e.find(".cropper-crop-box"),this.$viewBox=e.find(".cropper-view-box"),this.addListeners(),this.initPreview(),b.aspectRatio=x(b.aspectRatio)||NaN,b.autoCrop?(this.cropped=
!0,b.modal&&this.$dragBox.addClass("cropper-modal")):c.addClass("cropper-hidden"),b.background&&e.addClass("cropper-bg"),b.highlight||c.find(".cropper-face").addClass("cropper-invisible"),b.guides||c.find(".cropper-dashed").addClass("cropper-hidden"),b.movable||c.find(".cropper-face").data("drag","move"),b.resizable||c.find(".cropper-line, .cropper-point").addClass("cropper-hidden"),this.setDragMode(b.dragCrop?"crop":"move"),this.built=!0,this.render(),a.one("built.cropper",b.built).trigger("built.cropper"))},
unbuild:function(){this.built&&(this.built=!1,this.cropBox=this.canvas=this.container=null,this.removeListeners(),this.resetPreview(),this.$container=this.$canvas=this.$dragBox=this.$cropBox=this.$viewBox=this.$preview=null,this.$cropper.remove(),this.$cropper=null)}};k.extend(y,{render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.$element,c=this.$container,b=this.$cropper,e=this.options;
b.addClass("cropper-hidden");a.removeClass("cropper-hidden");b.css(this.container={width:n(c.width(),x(e.minContainerWidth)||200),height:n(c.height(),x(e.minContainerHeight)||100)});a.addClass("cropper-hidden");b.removeClass("cropper-hidden")},initCanvas:function(){var a=this.container,c=a.width,a=a.height,b=this.image,e=b.aspectRatio,f={aspectRatio:e,width:c,height:a};a*e>c?f.height=c/e:f.width=a*e;f.oldLeft=f.left=(c-f.width)/2;f.oldTop=f.top=(a-f.height)/2;this.canvas=f;this.limitCanvas(!0,!0);
this.initialImage=k.extend({},b);this.initialCanvas=k.extend({},f)},limitCanvas:function(a,c){var b=this.options,e=b.strict,f=this.container,d=f.width,f=f.height,g=this.canvas,h=g.aspectRatio,w=this.cropBox,J=this.cropped&&w,q;a&&(q=x(b.minCanvasWidth)||0,b=x(b.minCanvasHeight)||0,q?(e&&(q=n(J?w.width:d,q)),b=q/h):b?(e&&(b=n(J?w.height:f,b)),q=b*h):e&&(J?(q=w.width,b=w.height,b*h>q?q=b*h:b=q/h):(q=d,b=f,b*h>q?b=q/h:q=b*h)),k.extend(g,{minWidth:q,minHeight:b,maxWidth:Infinity,maxHeight:Infinity}));
c&&(e?J?(g.minLeft=t(w.left,w.left+w.width-g.width),g.minTop=t(w.top,w.top+w.height-g.height),g.maxLeft=w.left,g.maxTop=w.top):(g.minLeft=t(0,d-g.width),g.minTop=t(0,f-g.height),g.maxLeft=n(0,d-g.width),g.maxTop=n(0,f-g.height)):(g.minLeft=-g.width,g.minTop=-g.height,g.maxLeft=d,g.maxTop=f))},renderCanvas:function(a){var c=this.options,b=this.canvas,e=this.image,f;this.rotated&&(this.rotated=!1,f=F({width:e.width,height:e.height,degree:e.rotate}),e=f.width/f.height,e!==b.aspectRatio&&(b.left-=(f.width-
b.width)/2,b.top-=(f.height-b.height)/2,b.width=f.width,b.height=f.height,b.aspectRatio=e,this.limitCanvas(!0,!1)));if(b.width>b.maxWidth||b.width<b.minWidth)b.left=b.oldLeft;if(b.height>b.maxHeight||b.height<b.minHeight)b.top=b.oldTop;b.width=t(n(b.width,b.minWidth),b.maxWidth);b.height=t(n(b.height,b.minHeight),b.maxHeight);this.limitCanvas(!1,!0);b.oldLeft=b.left=t(n(b.left,b.minLeft),b.maxLeft);b.oldTop=b.top=t(n(b.top,b.minTop),b.maxTop);this.$canvas.css({width:b.width,height:b.height,left:b.left,
top:b.top});this.renderImage();this.cropped&&c.strict&&!H(this.container,b)&&this.limitCropBox(!0,!0);a&&this.output()},renderImage:function(){var a=this.canvas,c=this.image,b;c.rotate&&(b=F({width:a.width,height:a.height,degree:c.rotate,aspectRatio:c.aspectRatio},!0));k.extend(c,b?{width:b.width,height:b.height,left:(a.width-b.width)/2,top:(a.height-b.height)/2}:{width:a.width,height:a.height,left:0,top:0});this.$clone.css({width:c.width,height:c.height,marginLeft:c.left,marginTop:c.top,transform:E(c.rotate)})},
initCropBox:function(){var a=this.options,c=this.canvas,b=a.aspectRatio,a=x(a.autoCropArea)||.8,e={width:c.width,height:c.height};b&&(c.height*b>c.width?e.height=e.width/b:e.width=e.height*b);this.cropBox=e;this.limitCropBox(!0,!0);e.width=t(n(e.width,e.minWidth),e.maxWidth);e.height=t(n(e.height,e.minHeight),e.maxHeight);e.width=n(e.minWidth,e.width*a);e.height=n(e.minHeight,e.height*a);e.oldLeft=e.left=c.left+(c.width-e.width)/2;e.oldTop=e.top=c.top+(c.height-e.height)/2;this.initialCropBox=k.extend({},
e)},limitCropBox:function(a,c){var b=this.options,e=b.strict,f=this.container,d=f.width,f=f.height,g=this.canvas,h=this.cropBox,w=b.aspectRatio,k;a&&(k=x(b.minCropBoxWidth)||0,b=x(b.minCropBoxHeight)||0,h.minWidth=t(d,k),h.minHeight=t(f,b),h.maxWidth=t(d,e?g.width:d),h.maxHeight=t(f,e?g.height:f),w&&(h.maxHeight*w>h.maxWidth?(h.minHeight=h.minWidth/w,h.maxHeight=h.maxWidth/w):(h.minWidth=h.minHeight*w,h.maxWidth=h.maxHeight*w)),h.minWidth=t(h.maxWidth,h.minWidth),h.minHeight=t(h.maxHeight,h.minHeight));
c&&(e?(h.minLeft=n(0,g.left),h.minTop=n(0,g.top),h.maxLeft=t(d,g.left+g.width)-h.width,h.maxTop=t(f,g.top+g.height)-h.height):(h.minLeft=0,h.minTop=0,h.maxLeft=d-h.width,h.maxTop=f-h.height))},renderCropBox:function(){var a=this.options,c=this.container,b=c.width,e=c.height,f=this.$cropBox,d=this.cropBox;if(d.width>d.maxWidth||d.width<d.minWidth)d.left=d.oldLeft;if(d.height>d.maxHeight||d.height<d.minHeight)d.top=d.oldTop;d.width=t(n(d.width,d.minWidth),d.maxWidth);d.height=t(n(d.height,d.minHeight),
d.maxHeight);this.limitCropBox(!1,!0);d.oldLeft=d.left=t(n(d.left,d.minLeft),d.maxLeft);d.oldTop=d.top=t(n(d.top,d.minTop),d.maxTop);a.movable&&f.find(".cropper-face").data("drag",d.width===b&&d.height===e?"move":"all");f.css({width:d.width,height:d.height,left:d.left,top:d.top});this.cropped&&a.strict&&!H(c,this.canvas)&&this.limitCanvas(!0,!0);this.disabled||this.output()},output:function(){var a=this.options;this.preview();a.crop&&a.crop.call(this.$element,this.getData())}});y.initPreview=function(){var a=
this.url;this.$preview=k(this.options.preview);this.$viewBox.html('<img src="'+a+'">');this.$preview.each(function(){var c=k(this);c.data("preview.cropper",{width:c.width(),height:c.height(),original:c.html()}).html('<img src="'+a+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">')})};y.resetPreview=function(){this.$preview.each(function(){var a=k(this);a.html(a.data("preview.cropper").original).removeData("preview.cropper")})};
y.preview=function(){var a=this.image,c=this.canvas,b=this.cropBox,e=a.width,f=a.height,d=b.left-c.left-a.left,g=b.top-c.top-a.top,h=a.rotate;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({width:e,height:f,marginLeft:-d,marginTop:-g,transform:E(h)}),this.$preview.each(function(){var a=k(this),c=a.data("preview.cropper"),q=c.width/b.width,t=c.width,N=b.height*q;N>c.height&&(q=c.height/b.height,t=b.width*q,N=c.height);a.width(t).height(N).find("img").css({width:e*q,height:f*q,marginLeft:-d*
q,marginTop:-g*q,transform:E(h)})}))};y.addListeners=function(){var a=this.options;this.$element.on("dragstart.cropper",a.dragstart).on("dragmove.cropper",a.dragmove).on("dragend.cropper",a.dragend).on("zoomin.cropper",a.zoomin).on("zoomout.cropper",a.zoomout);this.$cropper.on("mousedown touchstart",k.proxy(this.dragstart,this)).on("dblclick",k.proxy(this.dblclick,this));if(a.zoomable&&a.mouseWheelZoom)this.$cropper.on("wheel mousewheel DOMMouseScroll",k.proxy(this.wheel,this));I.on("mousemove touchmove",
this._dragmove=D(this.dragmove,this)).on("mouseup mouseleave touchend touchleave touchcancel",this._dragend=D(this.dragend,this));if(a.responsive)B.on("resize.cropper",this._resize=D(this.resize,this))};y.removeListeners=function(){var a=this.options;this.$element.off("dragstart.cropper",a.dragstart).off("dragmove.cropper",a.dragmove).off("dragend.cropper",a.dragend).off("zoomin.cropper",a.zoomin).off("zoomout.cropper",a.zoomout);this.$cropper.off("mousedown touchstart",this.dragstart).off("dblclick",
this.dblclick);a.zoomable&&a.mouseWheelZoom&&this.$cropper.off("wheel mousewheel DOMMouseScroll",this.wheel);I.off("mousemove touchmove",this._dragmove).off("mouseup mouseleave touchend touchleave touchcancel",this._dragend);a.responsive&&B.off("resize.cropper",this._resize)};k.extend(y,{resize:function(){var a=this.$container,c=this.container,b,e,f;this.disabled||(f=a.width()/c.width,1===f&&a.height()===c.height)||(b=this.getCanvasData(),e=this.getCropBoxData(),this.render(),this.setCanvasData(k.each(b,
function(a,c){b[a]=c*f})),this.setCropBoxData(k.each(e,function(a,b){e[a]=b*f})))},dblclick:function(){this.disabled||(this.$dragBox.hasClass("cropper-crop")?this.setDragMode("move"):this.setDragMode("crop"))},wheel:function(a){var c=a.originalEvent,b=1;this.disabled||(a.preventDefault(),c.deltaY?b=0<c.deltaY?1:-1:c.wheelDelta?b=-c.wheelDelta/120:c.detail&&(b=0<c.detail?1:-1),this.zoom(.1*-b))},dragstart:function(a){var c=this.options,b=a.originalEvent,e=b&&b.touches,f=a,d;if(!this.disabled){if(e){f=
e.length;if(1<f)if(c.zoomable&&c.touchDragZoom&&2===f)f=e[1],this.startX2=f.pageX,this.startY2=f.pageY,d="zoom";else return;f=e[0]}d=d||k(f.target).data("drag");S.test(d)&&(a.preventDefault(),a=k.Event("dragstart.cropper",{originalEvent:b,dragType:d}),this.$element.trigger(a),a.isDefaultPrevented()||(this.dragType=d,this.cropping=!1,this.startX=f.pageX,this.startY=f.pageY,"crop"===d&&(this.cropping=!0,this.$dragBox.addClass("cropper-modal"))))}},dragmove:function(a){var c=this.options,b=a.originalEvent,
e=b&&b.touches,f=a,d=this.dragType;if(!this.disabled){if(e){f=e.length;if(1<f)if(c.zoomable&&c.touchDragZoom&&2===f)f=e[1],this.endX2=f.pageX,this.endY2=f.pageY;else return;f=e[0]}d&&(a.preventDefault(),a=k.Event("dragmove.cropper",{originalEvent:b,dragType:d}),this.$element.trigger(a),a.isDefaultPrevented()||(this.endX=f.pageX,this.endY=f.pageY,this.change()))}},dragend:function(a){var c=this.dragType;!this.disabled&&c&&(a.preventDefault(),a=k.Event("dragend.cropper",{originalEvent:a.originalEvent,
dragType:c}),this.$element.trigger(a),a.isDefaultPrevented()||(this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass("cropper-modal",this.cropped&&this.options.modal)),this.dragType=""))}});k.extend(y,{reset:function(){this.built&&!this.disabled&&(this.image=k.extend({},this.initialImage),this.canvas=k.extend({},this.initialCanvas),this.renderCanvas(),this.cropped&&(this.cropBox=k.extend({},this.initialCropBox),this.renderCropBox()))},clear:function(){this.cropped&&!this.disabled&&(k.extend(this.cropBox,
{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass("cropper-modal"),this.$cropBox.addClass("cropper-hidden"))},destroy:function(){var a=this.$element;this.ready?(this.unbuild(),a.removeClass("cropper-hidden")):this.$clone.off("load").remove();a.removeData("cropper")},replace:function(a){!this.disabled&&a&&this.load(a)},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass("cropper-disabled"))},
disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass("cropper-disabled"))},move:function(a,c){var b=this.canvas;this.built&&!this.disabled&&p(a)&&p(c)&&(b.left+=a,b.top+=c,this.renderCanvas(!0))},zoom:function(a){var c=this.canvas,b;(a=x(a))&&this.built&&!this.disabled&&this.options.zoomable&&(b=0<a?k.Event("zoomin.cropper"):k.Event("zoomout.cropper"),this.$element.trigger(b),b.isDefaultPrevented()||(a=-1>=a?1/(1-a):1>=a?1+a:a,b=c.width*a,a*=c.height,c.left-=(b-c.width)/2,c.top-=
(a-c.height)/2,c.width=b,c.height=a,this.renderCanvas(!0),this.setDragMode("move")))},rotate:function(a){var c=this.image;(a=x(a))&&this.built&&!this.disabled&&this.options.rotatable&&(c.rotate=(c.rotate+a)%360,this.rotated=!0,this.renderCanvas(!0))},getData:function(){var a=this.cropBox,c=this.canvas,b=this.image,e,f;this.built&&this.cropped?(f={x:a.left-c.left,y:a.top-c.top,width:a.width,height:a.height},e=b.width/b.naturalWidth,k.each(f,function(a,b){b/=e;f[a]=b})):f={x:0,y:0,width:0,height:0};
f.rotate=b.rotate;return f},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a=this.canvas,c;this.built&&(c={left:a.left,top:a.top,width:a.width,height:a.height});return c||{}},setCanvasData:function(a){var c=this.canvas,b=c.aspectRatio;this.built&&!this.disabled&&k.isPlainObject(a)&&(p(a.left)&&(c.left=a.left),p(a.top)&&(c.top=a.top),p(a.width)?(c.width=a.width,c.height=a.width/b):p(a.height)&&(c.height=
a.height,c.width=a.height*b),this.renderCanvas(!0))},getCropBoxData:function(){var a=this.cropBox,c;this.built&&this.cropped&&(c={left:a.left,top:a.top,width:a.width,height:a.height});return c||{}},setCropBoxData:function(a){var c=this.cropBox,b=this.options.aspectRatio;this.built&&this.cropped&&!this.disabled&&k.isPlainObject(a)&&(p(a.left)&&(c.left=a.left),p(a.top)&&(c.top=a.top),b?p(a.width)?(c.width=a.width,c.height=c.width/b):p(a.height)&&(c.height=a.height,c.width=c.height*b):(p(a.width)&&(c.width=
a.width),p(a.height)&&(c.height=a.height)),this.renderCropBox())},getCroppedCanvas:function(a){var c,b,e,f,d,g,h,w;if(this.built&&this.cropped&&O)return k.isPlainObject(a)||(a={}),w=this.getData(),c=w.width,b=w.height,g=c/b,k.isPlainObject(a)&&(e=a.width,f=a.height,e?(f=e/g,d=e/c):f&&(e=f*g,d=f/b)),e=e||c,f=f||b,g=k("<canvas>")[0],g.width=e,g.height=f,h=g.getContext("2d"),a.fillColor&&(h.fillStyle=a.fillColor,h.fillRect(0,0,e,f)),h.drawImage.apply(h,function(){var a=this.$clone[0],g=this.image,e=
k("<canvas>")[0],f=e.getContext("2d"),h=g.naturalWidth,v=g.naturalHeight,g=g.rotate,p=F({width:h,height:v,degree:g});g?(e.width=p.width,e.height=p.height,f.save(),f.translate(p.width/2,p.height/2),f.rotate(g*Math.PI/180),f.drawImage(a,-h/2,-v/2,h,v),f.restore()):(e.width=h,e.height=v,f.drawImage(a,0,0,h,v));var a=e.width,f=e.height,e=[e],h=w.x,v=w.y,u,m,l,n,r,C;h<=-c||h>a?h=u=l=r=0:0>=h?(l=-h,h=0,u=r=t(a,c+h)):h<=a&&(l=0,u=r=t(c,a-h));0>=u||v<=-b||v>f?v=m=n=C=0:0>=v?(n=-v,v=0,m=C=t(f,b+v)):v<=f&&
(n=0,m=C=t(b,f-v));e.push(h,v,u,m);d&&(l*=d,n*=d,r*=d,C*=d);0<r&&0<C&&e.push(l,n,r,C);return e}.call(this)),g},setAspectRatio:function(a){var c=this.options;this.disabled||"undefined"===typeof a||(c.aspectRatio=x(a)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var c=this.$dragBox,b=!1,e=!1;if(this.ready&&!this.disabled){switch(a){case "crop":this.options.dragCrop?(b=!0,c.data("drag",a)):e=!0;break;case "move":e=!0;c.data("drag",a);break;default:c.removeData("drag")}c.toggleClass("cropper-crop",
b).toggleClass("cropper-move",e)}}});y.change=function(){var a=this.dragType,c=this.options,b=this.canvas,e=this.container,f=this.cropBox,d=f.width,g=f.height,h=f.left,k=f.top,n=h+d,q=k+g,p=0,r=0,x=e.width,v=e.height,z=!0,u=c.aspectRatio,m=this.endX-this.startX,l=this.endY-this.startY,y,A;c.strict&&(p=f.minLeft,r=f.minTop,x=p+t(e.width,b.width),v=r+t(e.height,b.height));u&&(y=l*u,A=m/u);switch(a){case "all":h+=m;k+=l;break;case "e":if(0<=m&&(n>=x||u&&(k<=r||q>=v))){z=!1;break}d+=m;u&&(g=d/u,k-=A/
2);0>d&&(a="w",d=0);break;case "n":if(0>=l&&(k<=r||u&&(h<=p||n>=x))){z=!1;break}g-=l;k+=l;u&&(d=g*u,h+=y/2);0>g&&(a="s",g=0);break;case "w":if(0>=m&&(h<=p||u&&(k<=r||q>=v))){z=!1;break}d-=m;h+=m;u&&(g=d/u,k+=A/2);0>d&&(a="e",d=0);break;case "s":if(0<=l&&(q>=v||u&&(h<=p||n>=x))){z=!1;break}g+=l;u&&(d=g*u,h-=y/2);0>g&&(a="n",g=0);break;case "ne":if(u){if(0>=l&&(k<=r||n>=x)){z=!1;break}g-=l;k+=l;d=g*u}else 0<=m?n<x?d+=m:0>=l&&k<=r&&(z=!1):d+=m,0>=l?0<k&&(g-=l,k+=l):(g-=l,k+=l);0>d&&0>g?(a="sw",d=g=0):
0>d?(a="nw",d=0):0>g&&(a="se",g=0);break;case "nw":if(u){if(0>=l&&(k<=r||h<=p)){z=!1;break}g-=l;k+=l;d=g*u;h+=y}else 0>=m?0<h?(d-=m,h+=m):0>=l&&k<=r&&(z=!1):(d-=m,h+=m),0>=l?0<k&&(g-=l,k+=l):(g-=l,k+=l);0>d&&0>g?(a="se",d=g=0):0>d?(a="ne",d=0):0>g&&(a="sw",g=0);break;case "sw":if(u){if(0>=m&&(h<=p||q>=v)){z=!1;break}d-=m;h+=m;g=d/u}else 0>=m?0<h?(d-=m,h+=m):0<=l&&q>=v&&(z=!1):(d-=m,h+=m),0<=l?q<v&&(g+=l):g+=l;0>d&&0>g?(a="ne",d=g=0):0>d?(a="se",d=0):0>g&&(a="nw",g=0);break;case "se":if(u){if(0<=m&&
(n>=x||q>=v)){z=!1;break}d+=m;g=d/u}else 0<=m?n<x?d+=m:0<=l&&q>=v&&(z=!1):d+=m,0<=l?q<v&&(g+=l):g+=l;0>d&&0>g?(a="nw",d=g=0):0>d?(a="sw",d=0):0>g&&(a="ne",g=0);break;case "move":b.left+=m;b.top+=l;this.renderCanvas(!0);z=!1;break;case "zoom":this.zoom(function(a,b,c,d){a=P(a*a+b*b);return(P(c*c+d*d)-a)/a}(G(this.startX-this.startX2),G(this.startY-this.startY2),G(this.endX-this.endX2),G(this.endY-this.endY2)));this.startX2=this.endX2;this.startY2=this.endY2;z=!1;break;case "crop":m&&l&&(a=this.$cropper.offset(),
h=this.startX-a.left,k=this.startY-a.top,d=f.minWidth,g=f.minHeight,0<m?0<l?a="se":(a="ne",k-=g):0<l?(a="sw",h-=d):(a="nw",h-=d,k-=g),this.cropped||(this.cropped=!0,this.$cropBox.removeClass("cropper-hidden")))}z&&(f.width=d,f.height=g,f.left=h,f.top=k,this.dragType=a,this.renderCropBox());this.startX=this.endX;this.startY=this.endY};k.extend(r.prototype,y);r.DEFAULTS={aspectRatio:NaN,autoCropArea:.8,crop:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,highlight:!0,
background:!0,autoCrop:!0,dragCrop:!0,movable:!0,resizable:!0,rotatable:!0,zoomable:!0,touchDragZoom:!0,mouseWheelZoom:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null};r.setDefaults=function(a){k.extend(r.DEFAULTS,a)};r.TEMPLATE=function(a,c){c=c.split(",");return a.replace(/\d+/g,function(a){return c[a]})}('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9" 3-2="move"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face" 3-2="all"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',
"div,span,drag,data,point,cropper,class,line,dashed,box");r.other=k.fn.cropper;k.fn.cropper=function(a){var c=A(arguments,1),b;this.each(function(){var e=k(this),f=e.data("cropper"),d;f||e.data("cropper",f=new r(this,a));"string"===typeof a&&k.isFunction(d=f[a])&&(b=d.apply(f,c))});return"undefined"===typeof b?this:b};k.fn.cropper.Constructor=r;k.fn.cropper.setDefaults=r.setDefaults;k.fn.cropper.noConflict=function(){k.fn.cropper=r.other;return this}});
function convertToData(k,p,A,D){var K=A.width,M=A.height,H=p.width,E=p.height,F=p.left-A.left,r=p.top-A.top,B=document.createElement("canvas"),I=B.getContext("2d");B.width=K;B.height=M;p=new Image;p.src=k+"?"+(new Date).getTime();p.onload=function(){this.width=H;this.height=E;I.drawImage(this,F,r,this.width,this.height);var k=B.toDataURL("image/jpg",1);D&&D(k)}};